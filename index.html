<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Fortaleza | Banco Fortaleza</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:ital,wght@0,400;0,600;0,700;1,600&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['Inter', 'sans-serif'], 
                        display: ['Poppins', 'sans-serif'] 
                    },
                    colors: {
                        brand: { navy: '#002855', blue: '#004B87', orange: '#FF6B00', light: '#F8FAFC' }
                    },
                    animation: {
                        'bar-down': 'barDown 0.8s cubic-bezier(0.65, 0, 0.35, 1) forwards',
                        'logo-fade': 'logoFade 1.5s cubic-bezier(0.22, 1, 0.36, 1) 0.6s forwards',
                        'text-reveal': 'textReveal 1.2s cubic-bezier(0.22, 1, 0.36, 1) 1s forwards',
                        'sweep-shine': 'sweepShine 4s linear infinite'
                    },
                    keyframes: {
                        barDown: { '0%': { transform: 'translateY(-100%)' }, '100%': { transform: 'translateY(0)' } },
                        logoFade: { '0%': { opacity: '0', transform: 'scale(0.99) translateY(0)' }, '100%': { opacity: '1', transform: 'scale(1) translateY(0)' } },
                        textReveal: { '0%': { opacity: '0', transform: 'translateY(15px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        sweepShine: { '0%': { left: '-100%' }, '30%': { left: '100%' }, '100%': { left: '100%' } }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #FDFDFD; overflow-x: hidden; font-family: 'Inter', sans-serif; }
        
        .blue-franja { 
            height: 110px; 
            background: #002855;
            width: 100%; 
            position: absolute; 
            top: 0; 
            left: 0; 
            z-index: 0; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            overflow: hidden;
        }

        .franja-shine {
            position: absolute;
            top: 0;
            left: -100%;
            width: 40%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            z-index: 1;
        }

        .glass-dark {
            background: linear-gradient(145deg, #002855 0%, #001228 100%);
            box-shadow: 0 30px 60px -12px rgba(0, 15, 40, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .hover-grow { transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1); }
        .hover-grow:hover { transform: translateY(-3px); }

        .glow-main { transition: all 0.5s ease; cursor: default; }
        .glow-main:hover { transform: scale(1.01); }
        .glow-main:hover span {
            color: #FFFFFF !important;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }
        .glow-main span { transition: all 0.5s ease; display: inline-block; }

        .slider-premium { -webkit-appearance: none; width: 100%; height: 4px; background: #E2E8F0; border-radius: 999px; outline: none; }
        .slider-premium::-webkit-slider-thumb { 
            -webkit-appearance: none; width: 24px; height: 24px; 
            background: #FF6B00; border-radius: 50%; cursor: pointer; 
            border: 3px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); 
            transition: all 0.3s ease;
        }
        .slider-premium::-webkit-slider-thumb:hover { transform: scale(1.1); }
        
        .module-btn { transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1); background: #002855; color: #FFFFFF; border: none; }
        .module-btn:hover { transform: translateY(-2px); background: #003a7a; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .module-btn.active-tab { background: #FF6B00 !important; color: white !important; box-shadow: 0 10px 20px rgba(255, 107, 0, 0.25); }

        .product-pill { 
            transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1); 
            border: 1px solid #E2E8F0; 
            background: white; 
            color: #64748B; 
            line-height: 1.2; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            position: relative;
        }
        .product-pill:hover { transform: translateY(-2px); border-color: #002855; color: #002855; box-shadow: 0 8px 15px rgba(0,0,0,0.05); }
        .product-pill.active { background: #002855 !important; color: white !important; border-color: #002855 !important; box-shadow: 0 8px 15px rgba(0,40,85,0.2); }

        .card-pro { transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1); border: 1px solid #F1F5F9; background: white; }
        .card-pro:hover { transform: translateY(-5px); border-color: #FF6B00; box-shadow: 0 15px 30px rgba(0,0,0,0.05); }

        .btn-shine { position: relative; overflow: hidden; }
        .btn-shine::after { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.15), transparent); transform: rotate(45deg); animation: shine 6s infinite; }
        @keyframes shine { 0% { left: -100%; } 100% { left: 100%; } }

        .modal-overlay { backdrop-filter: blur(8px); background: rgba(0, 10, 30, 0.6); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }

        #custom-alert {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 200;
            background: #002855;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            border: 1px solid #FF6B00;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .monto-input-wrapper { position: relative; display: flex; align-items: center; }
        .monto-input {
            width: 100%;
            background: transparent;
            border-bottom: 2px solid #E2E8F0;
            color: #002855;
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 2.5rem;
            padding: 0.5rem 60px 0.5rem 0;
            outline: none;
            transition: border-color 0.3s ease;
        }
        .monto-input:focus { border-color: #FF6B00; }
        @media (min-width: 768px) {
            .monto-input { font-size: 3rem; }
        }

        .monto-arrows {
            position: absolute;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .monto-arrow-btn {
            background: #F1F5F9;
            color: #002855;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        .monto-arrow-btn:hover { background: #002855; color: white; }
        .monto-arrow-btn:active { transform: scale(0.9); }

        .custom-select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23002855'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1rem;
        }
    </style>
</head>
<body class="antialiased text-slate-700 pb-10 md:pb-20">

    <div id="custom-alert"></div>

    <!-- CABECERA -->
    <div class="blue-franja animate-bar-down">
        <div class="franja-shine animate-sweep-shine"></div>
    </div>
    
    <header class="relative z-10 text-center">
        <div class="h-[110px] flex items-center justify-center opacity-0 animate-logo-fade">
             <!-- LOGO ACTUALIZADO -->
             <img src="https://i.ibb.co/rLZLtT5/logo-blanco-naranja.png" alt="Banco Fortaleza" class="h-10 md:h-14 drop-shadow-xl transition-all duration-1000 ease-in-out hover:scale-105 cursor-pointer">
        </div>
        <div class="pt-6 md:pt-10 pb-8 md:pb-12 px-4 opacity-0 animate-text-reveal">
            <h1 class="text-3xl md:text-5xl font-display font-bold text-brand-navy tracking-tighter mb-2 italic hover-grow cursor-default transition-all duration-700">Calculadora Fortaleza</h1>
            <p class="text-slate-400 font-bold text-[9px] md:text-xs uppercase tracking-[0.3em]">Proyecciones Financieras con Inteligencia</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 relative z-20">
        
        <!-- SELECTOR MÓDULO -->
        <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-4 md:mb-6">
            <button onclick="changeMode('DPF')" id="btn-DPF" class="module-btn flex items-center gap-2 md:gap-3 px-6 md:px-10 py-3 md:py-4 rounded-xl font-bold active-tab text-sm md:text-base">
                <i class="fa-solid fa-chart-line"></i> DPF
            </button>
            <button onclick="changeMode('AHORRO')" id="btn-AHORRO" class="module-btn flex items-center gap-2 md:gap-3 px-6 md:px-10 py-3 md:py-4 rounded-xl font-bold text-sm md:text-base">
                <i class="fa-solid fa-piggy-bank"></i> Ahorro
            </button>
            <button onclick="changeMode('CREDITO')" id="btn-CREDITO" class="module-btn flex items-center gap-2 md:gap-3 px-6 md:px-10 py-3 md:py-4 rounded-xl font-bold text-sm md:text-base">
                <i class="fa-solid fa-hand-holding-dollar"></i> Créditos
            </button>
        </div>

        <!-- PRODUCTOS -->
        <div id="product-selectors" class="flex flex-nowrap md:flex-wrap justify-start md:justify-center gap-2 mb-6 md:mb-8 overflow-x-auto py-3 md:py-4 hide-scrollbar px-2"></div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 md:gap-10 items-start">
            
            <!-- CONTENEDOR LATERAL (INPUTS) -->
            <div class="lg:col-span-5 space-y-6 md:space-y-8">
                
                <!-- BLOQUE 1: CONFIGURACIÓN DE DATOS -->
                <div class="bg-white p-6 md:p-10 rounded-[2.5rem] md:rounded-[3rem] border border-slate-50 shadow-xl space-y-8">
                    
                    <!-- Entrada Manual: Capital con Flechas -->
                    <div>
                        <div class="flex justify-between items-end mb-2">
                            <label class="text-[9px] font-black text-slate-300 uppercase tracking-widest">Capital a Proyectar</label>
                            <span class="text-lg font-black text-brand-orange">Bs</span>
                        </div>
                        <div class="monto-input-wrapper">
                            <input type="text" id="input-monto" 
                                   class="monto-input tracking-tighter" 
                                   placeholder="0"
                                   oninput="formatMontoInput(this)">
                            <div class="monto-arrows">
                                <button onclick="stepMonto(1000)" class="monto-arrow-btn" title="Aumentar 1.000"><i class="fa-solid fa-chevron-up"></i></button>
                                <button onclick="stepMonto(-1000)" class="monto-arrow-btn" title="Disminuir 1.000"><i class="fa-solid fa-chevron-down"></i></button>
                            </div>
                        </div>
                        <div class="flex justify-between text-[8px] font-bold text-slate-300 mt-2 uppercase transition-colors duration-300" id="monto-labels-container">
                            <span id="min-monto-label">1.000 Bs</span>
                            <span id="max-monto-label">10M Bs</span>
                        </div>
                    </div>

                    <!-- Slider: Plazo -->
                    <div>
                        <div class="flex justify-between items-end mb-4">
                            <label class="text-[9px] font-black text-slate-300 uppercase tracking-widest">Plazo del Plan</label>
                            <div class="flex items-baseline gap-1">
                                <span id="display-plazo" class="text-4xl md:text-5xl font-display font-bold text-brand-navy tracking-tighter">0</span>
                                <span id="unit-label" class="text-lg font-black text-brand-orange uppercase">días</span>
                            </div>
                        </div>
                        <input type="range" id="slider-plazo" class="slider-premium" oninput="updateCalculations()">
                        <div class="flex justify-between text-[8px] font-bold text-slate-300 mt-3 uppercase">
                            <span id="min-plazo-label">90</span>
                            <span id="max-plazo-label">1.080</span>
                        </div>
                    </div>
                </div>

                <!-- BLOQUE ACCIONES ESCRITORIO -->
                <div class="hidden lg:block bg-white p-6 md:p-10 rounded-[2.5rem] md:rounded-[3rem] border border-slate-50 shadow-xl space-y-6" id="actions-desktop"></div>
            </div>

            <!-- RESULTADOS -->
            <div class="lg:col-span-7 space-y-6 md:space-y-8">
                
                <div class="glass-dark rounded-[2.5rem] md:rounded-[3.5rem] p-8 md:p-12 text-white relative shadow-2xl overflow-hidden border border-white/5">
                    <div class="relative z-10">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8 md:mb-10">
                            <p id="main-result-label" class="text-brand-orange font-bold text-[9px] md:text-xs uppercase tracking-[0.4em]">GANANCIA ESTIMADA</p>
                            <div class="flex items-center gap-3 bg-brand-orange px-4 py-2 rounded-xl border border-white/20 shadow-md hover-grow cursor-default">
                                <span class="text-[8px] text-white font-black uppercase tracking-widest">TEA</span>
                                <span id="rate-badge" class="text-white text-xl md:text-2xl font-display font-black">6.00%</span>
                            </div>
                        </div>
                        
                        <div class="mb-8 md:mb-10">
                            <div class="glow-main inline-block">
                                <span id="main-result-value" class="text-6xl sm:text-8xl md:text-9xl font-display font-bold tracking-tighter leading-none transition-all">0</span>
                                <span class="text-2xl md:text-4xl font-bold uppercase ml-2">Bs</span>
                            </div>
                        </div>

                        <div id="secondary-result" class="grid grid-cols-2 gap-6 border-t border-white/10 pt-8"></div>
                    </div>
                </div>

                <div class="px-2">
                    <h3 class="text-[8px] md:text-[9px] font-black text-slate-400 uppercase tracking-[0.4em] mb-6 flex items-center gap-3">
                        <span class="w-8 h-[1px] bg-slate-200"></span> PROYECCIÓN EN OTROS TIEMPOS
                    </h3>
                    <div id="perspective-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>

                <!-- BLOQUE ACCIONES MÓVIL -->
                <div class="lg:hidden bg-white p-6 rounded-[2.5rem] border border-slate-50 shadow-xl space-y-6 mb-10" id="actions-mobile"></div>

            </div>
        </div>
    </main>

    <!-- MODAL -->
    <div id="leadModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4 modal-overlay" onclick="if(event.target === this) closeLeadModal()">
        <div class="bg-white w-full max-w-md rounded-[2rem] overflow-hidden shadow-2xl border border-white/20 relative" onclick="event.stopPropagation()">
            <button onclick="closeLeadModal()" class="absolute top-6 right-6 text-slate-300 hover:text-brand-orange transition-colors"><i class="fa-solid fa-xmark text-xl"></i></button>
            <div class="p-8 md:p-10">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-display font-bold text-brand-navy tracking-tight">Solicitud Personalizada</h2>
                    <p class="text-slate-400 text-sm mt-1 font-medium italic">Un oficial senior te contactará en breve.</p>
                </div>
                <div class="space-y-4">
                    <div class="p-5 bg-slate-50 rounded-xl border border-slate-100 flex justify-between items-center">
                        <div class="max-w-[70%]">
                            <p class="text-[8px] font-black text-slate-400 uppercase mb-0.5" id="modal-summary-label">Monto Solicitado</p>
                            <span class="text-xs font-bold text-brand-navy leading-tight" id="modal-summary-prod">DPF Premium</span>
                        </div>
                        <span class="text-xl font-black text-brand-orange" id="modal-summary-monto">0 Bs</span>
                    </div>
                    <div class="space-y-3">
                        <input type="text" id="leadName" placeholder="Tu nombre" class="w-full p-4 bg-slate-50 border border-slate-100 focus:border-brand-orange rounded-xl outline-none transition-all font-semibold text-sm">
                        <input type="tel" id="leadPhone" placeholder="Tu número de celular" class="w-full p-4 bg-slate-50 border border-slate-100 focus:border-brand-orange rounded-xl outline-none transition-all font-semibold text-sm">
                        <select id="leadCity" class="w-full p-4 bg-slate-50 border border-slate-100 focus:border-brand-orange rounded-xl outline-none transition-all font-semibold text-sm text-slate-600 appearance-none cursor-pointer custom-select">
                            <option value="" disabled selected>Selecciona tu ciudad</option>
                            <option value="La Paz">La Paz</option>
                            <option value="El Alto">El Alto</option>
                            <option value="Santa Cruz">Santa Cruz</option>
                            <option value="Cochabamba">Cochabamba</option>
                            <option value="Oruro">Oruro</option>
                            <option value="Potosí">Potosí</option>
                            <option value="Tarija">Tarija</option>
                            <option value="Chuquisaca">Chuquisaca</option>
                            <option value="Beni">Beni</option>
                            <option value="Pando">Pando</option>
                        </select>
                    </div>
                    <button onclick="submitLead()" class="btn-shine w-full py-4 bg-brand-orange text-white font-bold rounded-xl shadow-lg shadow-orange-600/20 hover:bg-orange-600 transition-all text-xs uppercase tracking-widest mt-2">CONFIRMAR Y ENVIAR</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            DPF: [{ id: 'dpf', prefix: 'Inversión', name: 'DPF Premium', icon: 'fa-chart-line', min: 1000, max: 10000000, minP: 90, maxP: 1080, unit: 'días', stepTime: 10, req: ["Tasa fija anual garantizada.", "Renovación automática disponible.", "Oferta limitada vigente hasta el 31/12/2025."] }],
            AHORRO: [
                { id: 'agil', prefix: 'Caja de Ahorro', name: 'Fortaleza Ágil', icon: 'fa-bolt', min: 1000, max: 10000000, minP: 1, maxP: 120, unit: 'meses', stepTime: 1, req: ["Retiros ilimitados sin costo.", "Cero cobro de mantenimiento mensual.", "Disponibilidad inmediata de fondos.", "Capitalización mensual de intereses."] },
                { id: 'crece', prefix: 'Caja de Ahorro', name: 'Fortaleza Crece', icon: 'fa-arrow-up-right-dots', min: 5000, max: 10000000, minP: 1, maxP: 120, unit: 'meses', stepTime: 1, req: ["Tasa preferencial para saldos > Bs 350,000.", "Permite 5 retiros libres al mes.", "Sin cargos administrativos de mantenimiento.", "Ideal para ahorros progresivos."] }
            ],
            CREDITO: [
                { id: 'consumo', prefix: 'Crédito', name: 'Consumo', icon: 'fa-cart-shopping', min: 14000, max: 210000, minP: 12, maxP: 60, unit: 'meses', stepTime: 1, req: ["Libre disponibilidad (viajes, salud, compras).", "A sola firma hasta Bs 210,000.", "Tasa fija durante el primer año.", "Aprobación ágil para Plan Sueldo."] },
                { id: 'vehicular', prefix: 'Crédito', name: 'Vehicular', icon: 'fa-car', min: 35000, max: 350000, minP: 12, maxP: 60, unit: 'meses', stepTime: 1, req: ["Financia el 80% en vehículos nuevos.", "Garantía prendaria (el mismo vehículo).", "Tasa fija los primeros 12 meses.", "Seguro automotor incluido en cuota."] },
                { id: 'vivienda', prefix: 'Crédito', name: 'Vivienda Tradicional', icon: 'fa-house', min: 140000, max: 3500000, minP: 12, maxP: 240, unit: 'meses', stepTime: 1, req: ["Plazo extendido hasta 20 años (240 meses).", "Financiamiento del 80% del valor comercial.", "Tasa mínima competitiva para montos altos.", "Seguro de desgravamen incluido."] }
            ]
        };

        let activeMode = 'DPF', activeProduct = CONFIG.DPF[0], lastResult = 0;
        const formatter = new Intl.NumberFormat('es-BO', { minimumFractionDigits: 0, maximumFractionDigits: 0 });

        function showMessage(text) {
            const el = document.getElementById('custom-alert');
            el.innerText = text; el.style.display = 'block';
            setTimeout(() => { el.style.display = 'none'; }, 4000);
        }

        function formatMontoInput(input) {
            let value = input.value.replace(/\D/g, ""); 
            let start = input.selectionStart;
            let oldLen = input.value.length;

            if (value !== "") {
                let numericValue = parseInt(value, 10);
                if (numericValue > activeProduct.max) numericValue = activeProduct.max;
                input.value = formatter.format(numericValue);
                
                let newLen = input.value.length;
                input.setSelectionRange(start + (newLen - oldLen), start + (newLen - oldLen));
            } else {
                input.value = "";
            }
            updateCalculations();
        }

        function stepMonto(delta) {
            let current = getMontoNumeric();
            let next = current + delta;
            if (next < activeProduct.min) next = activeProduct.min;
            if (next > activeProduct.max) next = activeProduct.max;
            document.getElementById('input-monto').value = formatter.format(next);
            updateCalculations();
        }

        function getMontoNumeric() {
            const input = document.getElementById('input-monto');
            const val = input.value.replace(/\D/g, "");
            return val === "" ? activeProduct.min : parseInt(val, 10);
        }

        function changeMode(mode) {
            activeMode = mode;
            ['DPF', 'AHORRO', 'CREDITO'].forEach(m => {
                const btn = document.getElementById(`btn-${m}`);
                m === mode ? btn.classList.add('active-tab') : btn.classList.remove('active-tab');
            });
            renderProductPills();
        }

        function renderProductPills() {
            const container = document.getElementById('product-selectors');
            container.innerHTML = '';
            CONFIG[activeMode].forEach((prod, idx) => {
                const btn = document.createElement('button');
                btn.className = `product-pill px-6 md:px-10 py-4 md:py-5 rounded-xl md:rounded-2xl text-[9px] md:text-[10px] font-bold transition-all uppercase tracking-widest flex-shrink-0 ${idx === 0 ? 'active' : ''}`;
                btn.innerHTML = `<i class="fa-solid ${prod.icon} mr-2"></i> ${prod.name}`;
                btn.onclick = () => {
                    document.querySelectorAll('.product-pill').forEach(p => p.classList.remove('active'));
                    btn.classList.add('active'); setProduct(prod);
                };
                container.appendChild(btn);
            });
            setProduct(CONFIG[activeMode][0]);
        }

        function setProduct(prod) {
            activeProduct = prod;
            const inputMonto = document.getElementById('input-monto');
            const sp = document.getElementById('slider-plazo');
            
            let currentMonto = getMontoNumeric();
            if(currentMonto < prod.min) currentMonto = prod.min;
            if(currentMonto > prod.max) currentMonto = prod.max;
            inputMonto.value = formatter.format(currentMonto);
            inputMonto.placeholder = `Mín: ${formatter.format(prod.min)}`;

            sp.min = prod.minP; sp.max = prod.maxP; sp.value = prod.minP; sp.step = prod.stepTime;
            document.getElementById('min-monto-label').innerText = formatter.format(prod.min) + " Bs";
            document.getElementById('max-monto-label').innerText = formatter.format(prod.max) + " Bs";
            document.getElementById('min-plazo-label').innerText = prod.minP;
            document.getElementById('max-plazo-label').innerText = prod.maxP;
            document.getElementById('unit-label').innerText = prod.unit;
            renderActionBlocks(prod);
            updateCalculations();
        }

        function renderActionBlocks(prod) {
            const content = `
                <div class="space-y-4">
                    <button onclick="openLeadModal()" class="btn-shine w-full py-4 md:py-5 bg-brand-navy text-white font-bold rounded-2xl hover:bg-brand-blue transition-all flex items-center justify-center gap-3 text-base md:text-lg shadow-xl active:scale-95">
                        <i class="fa-solid fa-crown text-brand-orange"></i> QUIERO MI PLAN
                    </button>
                    <button onclick="sendWhatsApp()" class="w-full py-4 border-2 border-emerald-500 text-emerald-600 font-bold rounded-2xl hover:bg-emerald-50 transition-all flex items-center justify-center gap-2 text-sm">
                        <i class="fa-brands fa-whatsapp text-2xl"></i> CONSULTAR POR WHATSAPP
                    </button>
                </div>
                <div class="pt-2">
                    <h4 class="text-[8px] font-black text-brand-navy uppercase tracking-widest mb-2 border-b border-slate-100 pb-1">Condiciones del Plan</h4>
                    <ul class="space-y-1.5">
                        ${prod.req.map(item => `
                            <li class="text-[10px] text-slate-900 leading-tight font-medium flex items-start gap-2 animate-text-reveal">
                                <i class="fa-solid fa-circle-check text-brand-orange mt-0.5 text-[8px]"></i> <span>${item}</span>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `;
            document.getElementById('actions-desktop').innerHTML = content;
            document.getElementById('actions-mobile').innerHTML = content;
        }

        function getTasa(monto, plazo) {
            if (activeProduct.id === 'dpf') return (plazo < 200) ? 0.05 : 0.06;
            if (activeProduct.id === 'agil') return 0.0425;
            if (activeProduct.id === 'crece') return (monto <= 350000) ? 0.045 : 0.055;
            if (activeProduct.id === 'consumo') {
                if (monto <= 35000) return 0.18; if (monto <= 70000) return 0.17;
                if (monto <= 105000) return 0.16; if (monto <= 140000) return 0.15;
                if (monto <= 175000) return 0.145; return 0.14;
            }
            if (activeProduct.id === 'vehicular') {
                if (monto <= 70000) return 0.14; if (monto <= 105000) return 0.135;
                if (monto <= 140000) return 0.13; if (monto <= 175000) return 0.125;
                if (monto <= 210000) return 0.1225; return 0.12;
            }
            if (activeProduct.id === 'vivienda') {
                const isLongTerm = plazo > 180;
                if (monto <= 210000) return isLongTerm ? 0.1225 : 0.12;
                if (monto <= 350000) return isLongTerm ? 0.1175 : 0.115;
                if (monto <= 490000) return isLongTerm ? 0.1125 : 0.11;
                if (monto <= 700000) return isLongTerm ? 0.1075 : 0.105;
                if (monto <= 1050000) return 0.1025; return 0.10;
            }
            return 0.05;
        }

        function calculateResults(m, p, t) {
            let res = 0;
            if (activeMode !== 'CREDITO') {
                activeProduct.id === 'dpf' ? res = m * t * (p / 360) : res = m * t * (p / 12);
            } else {
                const i = t / 12;
                const cuotaBase = m * (i * Math.pow(1 + i, p)) / (Math.pow(1 + i, p) - 1);
                res = cuotaBase + (m * 0.0006);
            }
            return Math.round(res);
        }

        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = formatter.format(Math.floor(progress * (end - start) + start));
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function updateCalculations() {
            const m = getMontoNumeric();
            const p = parseFloat(document.getElementById('slider-plazo').value);
            const t = getTasa(m, p);
            
            // Mejora: Validación de rango visual
            const minLabel = document.getElementById('min-monto-label');
            if (m < activeProduct.min) {
                minLabel.classList.remove('text-slate-300');
                minLabel.classList.add('text-brand-orange');
            } else {
                minLabel.classList.remove('text-brand-orange');
                minLabel.classList.add('text-slate-300');
            }

            document.getElementById('display-plazo').innerText = p;
            document.getElementById('rate-badge').innerText = `${(t*100).toFixed(2)}%`;
            
            const res = calculateResults(m, p, t);
            const resElement = document.getElementById('main-result-value');
            
            if(res !== lastResult) {
                animateValue(resElement, lastResult, res, 400);
                lastResult = res;
            } else {
                resElement.innerText = formatter.format(res);
            }

            const infoBox = document.getElementById('secondary-result');
            if (activeMode !== 'CREDITO') {
                document.getElementById('main-result-label').innerText = "GANANCIA ESTIMADA";
                infoBox.innerHTML = `
                    <div class="flex flex-col hover-grow cursor-default">
                        <span class="text-white/40 text-[8px] md:text-[9px] font-black uppercase tracking-widest mb-1.5">Monto Final (Capital + Interés)</span>
                        <span class="text-white font-bold text-2xl md:text-4xl tracking-tighter transition-all duration-500">${formatter.format(m + res)} Bs</span>
                    </div>
                    <div class="flex flex-col border-l border-white/10 pl-6 hover-grow cursor-default">
                        <span class="text-white/40 text-[8px] md:text-[9px] font-black uppercase tracking-widest mb-1.5">Rentabilidad</span>
                        <span class="text-brand-orange font-bold text-lg md:text-xl uppercase italic">Garantizada</span>
                    </div>`;
            } else {
                document.getElementById('main-result-label').innerText = "CUOTA MENSUAL ESTIMADA";
                infoBox.innerHTML = `
                    <div class="flex flex-col hover-grow cursor-default">
                        <!-- MEJORA: Etiqueta más comprensible -->
                        <span class="text-brand-orange text-[8px] md:text-[9px] font-black uppercase tracking-widest mb-1.5 leading-tight">Ahorro diario para cubrir cuota</span>
                        <div class="flex items-baseline gap-1">
                             <span class="text-white font-black text-3xl md:text-4xl tracking-tighter transition-all duration-500">${Math.round(res/30)} Bs</span>
                             <span class="text-[7px] text-white/40 uppercase font-black">/ día</span>
                        </div>
                    </div>
                    <div class="flex flex-col border-l border-white/10 pl-6 hover-grow cursor-default">
                        <span class="text-white/40 text-[8px] md:text-[9px] font-black uppercase tracking-widest mb-1.5">Ingreso sugerido</span>
                        <span class="text-white font-bold text-xl md:text-2xl tracking-tighter">${formatter.format(Math.round(res / 0.3))} Bs</span>
                    </div>`;
            }
            renderPerspectives(m);
        }

        function renderPerspectives(m) {
            const container = document.getElementById('perspective-grid'); container.innerHTML = '';
            const isCredito = activeMode === 'CREDITO', labelText = isCredito ? "Cuota Mensual" : "Ganancia Estimada";
            if (!isCredito) {
                const intervals = activeProduct.id === 'dpf' ? [{label: 'A 200 Días', p: 200}, {label: 'A 1 Año', p: 360}, {label: 'A 2 Años', p: 720}, {label: 'A 3 Años', p: 1080}] : [{label: 'A 6 Meses', p: 6}, {label: 'A 1 Año', p: 12}, {label: 'A 2 Años', p: 24}, {label: 'A 5 Años', p: 60}];
                intervals.forEach(item => {
                    const tasa = getTasa(m, item.p), ganancia = calculateResults(m, item.p, tasa);
                    container.innerHTML += `<div class="card-pro p-6 rounded-2xl group"><div class="flex justify-between items-center mb-4"><span class="text-[8px] font-bold text-brand-navy uppercase tracking-widest">${item.label}</span><span class="text-[8px] font-black text-brand-orange border border-brand-orange/20 px-2 py-1 rounded-md bg-orange-50/50">${(tasa*100).toFixed(2)}%</span></div><div class="flex flex-col"><span class="text-[8px] text-slate-400 font-bold uppercase mb-1">${labelText}</span><div class="flex items-baseline"><span class="text-3xl font-display font-bold text-brand-navy tracking-tighter">${formatter.format(ganancia)}</span><span class="text-base font-bold text-brand-navy ml-1">Bs</span></div></div></div>`;
                });
            } else {
                const plazos = [12, 24, 60, 120, 240].filter(val => val <= activeProduct.maxP && val >= activeProduct.minP);
                plazos.forEach(item => {
                    const tasa = getTasa(m, item), cuota = calculateResults(m, item, tasa);
                    container.innerHTML += `<div class="card-pro p-6 rounded-2xl group ${item === parseFloat(document.getElementById('slider-plazo').value) ? 'border-brand-orange bg-orange-50/20' : ''}"><div class="flex justify-between items-center mb-4"><span class="text-[8px] font-bold text-brand-navy uppercase tracking-widest">Plazo ${item} Meses</span><i class="fa-solid fa-shield-halved text-brand-orange text-[10px]"></i></div><div class="flex flex-col"><span class="text-[8px] text-slate-400 font-bold uppercase mb-1">${labelText}</span><div class="flex items-baseline"><span class="text-3xl font-display font-bold text-brand-navy tracking-tighter">${formatter.format(cuota)}</span><span class="text-base font-bold text-brand-navy ml-1">Bs</span></div></div></div>`;
                });
            }
        }

        function openLeadModal() { 
            const m = getMontoNumeric();
            document.getElementById('modal-summary-prod').innerText = `${activeProduct.prefix} ${activeProduct.name}`;
            document.getElementById('modal-summary-monto').innerText = formatter.format(m) + " Bs";
            document.getElementById('modal-summary-label').innerText = activeMode === 'CREDITO' ? "Monto Solicitado" : "Monto a Invertir";
            document.getElementById('leadModal').classList.remove('hidden'); 
        }

        function closeLeadModal() { document.getElementById('leadModal').classList.add('hidden'); }
        
        function submitLead() {
            const name = document.getElementById('leadName').value, phone = document.getElementById('leadPhone').value, city = document.getElementById('leadCity').value;
            if(!name || !phone || !city) { showMessage("Por favor, completa todos los campos."); return; }
            showMessage(`¡Excelente ${name} de ${city}! Solicitud enviada correctamente.`); closeLeadModal();
        }

        function sendWhatsApp() {
            const monto = formatter.format(getMontoNumeric());
            const plazo = document.getElementById('display-plazo').innerText;
            const res = formatter.format(lastResult);
            const resLabel = document.getElementById('main-result-label').innerText;
            const tasa = document.getElementById('rate-badge').innerText;
            
            const msg = `*SIMULACIÓN BANCO FORTALEZA*\n` +
                        `----------------------------------\n` +
                        `¡Hola! Realicé una simulación en su sitio web y deseo recibir asesoramiento personalizado:\n\n` +
                        `• *Producto:* ${activeProduct.prefix} ${activeProduct.name}\n` +
                        `• *Monto:* ${monto} Bs\n` +
                        `• *Plazo:* ${plazo} ${activeProduct.unit}\n` +
                        `• *Tasa (TEA):* ${tasa}\n` +
                        `• *${resLabel}:* ${res} Bs\n\n` +
                        `¿Podría un oficial de negocios contactarme para dar curso a mi solicitud?`;
            
            window.open(`https://wa.me/59164188659?text=${encodeURIComponent(msg)}`, '_blank');
        }

        window.onload = () => changeMode('DPF');
    </script>
</body>
</html>
